Нonest sign или по-русски Маркировка Честный знак.

Будем писать обработчик файлов .txt, полученных из 1С после эмиссии кодов маркировки (КМ).
Информация нужна для добавления КМ в Декларацию на товары (ДТ (бывшие ГТД)) для прохождения таможни.

Исходный файл содержит информацию о каждой КМ и имеет вид:
___
	86516																											
																												
																												
	Сапоги резиновые детские																											
																												
																												
																												
																												
																												
																												
																												
	бежевый, 22																											
																												
															(01)04690624090622(21)5_&MH"*%dBY4V													
																												
	04690624090622		
___

Обработчик принимает файл .txt и создает файл .xlsx или .xls, где:
1. Наименование файла: "86516, Сапоги резиновые детские, бежевый, 22, 120 пар"
2. Содержание файла: собирает уникальные коды пар обуви в один столбец и приводит их в требуемый формат: 
"0104690624090622215_&MH"*%dBY4V"